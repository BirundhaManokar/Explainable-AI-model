<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ClarivoX ‚Äî Explainable Banking AI</title>
<link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700;800&family=DM+Sans:opsz,wght@9..40,300;9..40,400;9..40,500;9..40,600;9..40,700&display=swap" rel="stylesheet"/>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#0D0B1F;--bg2:#13102B;--bg3:#1A1640;
  --card:#1E1A42;--card2:#251F50;
  --border:rgba(139,92,246,0.2);
  --indigo:#7C6EFA;--purple:#A855F7;--violet:#6366F1;
  --glow:rgba(124,110,250,0.35);
  --text:#F0EEFF;--text2:#B8B0D8;--text3:#7A6FAA;
  --success:#10B981;--danger:#EF4444;--warning:#F59E0B;
  --r:18px;--r-sm:10px;
  --sh:0 4px 32px rgba(124,110,250,0.18);
  --sh-lg:0 8px 56px rgba(124,110,250,0.32);
  --tr:0.3s cubic-bezier(.4,0,.2,1);
}
html{scroll-behavior:smooth}
body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden}
h1,h2,h3,h4,h5{font-family:'Sora',sans-serif}

.page{display:none;min-height:100vh;flex-direction:column}
.page.active{display:flex;animation:fadeUp .4s ease both}
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}

.orb{position:fixed;pointer-events:none;z-index:0;border-radius:50%;filter:blur(90px);opacity:.2;animation:orbf 12s ease-in-out infinite}
.o1{width:500px;height:500px;background:var(--indigo);top:-180px;right:-120px}
.o2{width:400px;height:400px;background:var(--purple);bottom:-120px;left:-120px;animation-delay:-5s;animation-duration:15s}
.o3{width:250px;height:250px;background:var(--violet);top:45%;left:48%;animation-delay:-8s;animation-duration:10s}
@keyframes orbf{0%,100%{transform:translateY(0) scale(1)}50%{transform:translateY(-28px) scale(1.08)}}

/* TOPBAR */
#topbar{position:fixed;top:0;left:0;right:0;z-index:200;height:64px;display:flex;align-items:center;justify-content:space-between;padding:0 28px;background:rgba(13,11,31,0.9);backdrop-filter:blur(20px);border-bottom:1px solid var(--border)}
.tb-logo{font-family:'Sora',sans-serif;font-weight:800;font-size:21px;background:linear-gradient(135deg,var(--indigo),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;cursor:pointer;letter-spacing:-0.5px}
.back-btn{display:none;align-items:center;gap:5px;background:rgba(124,110,250,0.1);border:1px solid var(--border);color:var(--text2);font-size:12px;font-weight:600;padding:6px 14px;border-radius:50px;cursor:pointer;transition:var(--tr);font-family:'DM Sans',sans-serif}
.back-btn:hover{background:rgba(124,110,250,0.2);color:var(--text)}
.back-btn.show{display:flex}
.tb-right{display:flex;align-items:center;gap:10px}
.tb-nav-link{padding:7px 14px;border-radius:50px;font-size:12px;font-weight:500;color:var(--text2);cursor:pointer;transition:var(--tr);background:transparent;border:none;font-family:'DM Sans',sans-serif}
.tb-nav-link:hover{color:var(--text);background:rgba(124,110,250,0.1)}
.profile-pill{display:flex;align-items:center;gap:8px;background:var(--card);border:1px solid var(--border);border-radius:50px;padding:5px 14px 5px 5px;cursor:pointer;transition:var(--tr)}
.profile-pill:hover{border-color:var(--indigo)}
.pav{width:32px;height:32px;border-radius:50%;background:linear-gradient(135deg,var(--indigo),var(--purple));display:flex;align-items:center;justify-content:center;font-size:13px;font-weight:700;color:#fff;font-family:'Sora',sans-serif}
.pname{font-size:12px;font-weight:600;color:var(--text)}
.pmode{font-size:10px;color:var(--text3)}
.step-bar{display:flex;align-items:center;gap:5px;flex:1;justify-content:center;padding:0 16px}
.sdot{width:6px;height:6px;border-radius:50%;background:var(--bg3);transition:var(--tr)}
.sdot.done{background:var(--indigo)}
.sdot.cur{background:var(--purple);transform:scale(1.6)}

/* PROFILE POPUP */
#ppopup{position:fixed;top:74px;right:28px;z-index:300;background:var(--card);border:1px solid var(--border);border-radius:var(--r);padding:18px;width:220px;box-shadow:var(--sh-lg);display:none;animation:slideIn .2s ease both}
#ppopup.open{display:block}
@keyframes slideIn{from{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}
.pp-head{margin-bottom:14px}
.pp-name{font-weight:700;font-size:14px;margin-bottom:2px}
.pp-email{font-size:11px;color:var(--text3)}
.pp-item{display:flex;align-items:center;gap:10px;padding:8px 0;border-top:1px solid var(--border);font-size:12px;color:var(--text2);cursor:pointer;transition:var(--tr)}
.pp-item:hover{color:var(--text)}

/* FLOATING CHAT */
#floatChat{position:fixed;bottom:26px;right:26px;z-index:500;width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,var(--indigo),var(--purple));display:none;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 6px 28px rgba(124,110,250,0.5);font-size:22px;transition:var(--tr);border:none;animation:popBounce .4s cubic-bezier(.34,1.56,.64,1) both}
#floatChat:hover{transform:scale(1.1) translateY(-2px)}
#floatChat.show{display:flex}
.fcbadge{position:absolute;top:-2px;right:-2px;width:16px;height:16px;background:var(--danger);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:9px;font-weight:700;color:#fff;border:2px solid var(--bg)}
@keyframes popBounce{from{opacity:0;transform:scale(0.4)}to{opacity:1;transform:scale(1)}}

/* CHAT PANEL */
#cpanel{position:fixed;bottom:94px;right:26px;z-index:499;width:320px;background:var(--card);border:1px solid var(--border);border-radius:var(--r);box-shadow:var(--sh-lg);display:none;flex-direction:column;overflow:hidden}
#cpanel.open{display:flex;animation:slideIn .25s ease both}
.cp-hd{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:linear-gradient(135deg,var(--indigo),var(--purple))}
.cp-title{font-weight:700;font-size:13px;color:#fff}
.cp-x{background:none;border:none;cursor:pointer;color:rgba(255,255,255,.75);font-size:20px;line-height:1}
.cp-msgs{flex:1;overflow-y:auto;padding:12px;display:flex;flex-direction:column;gap:10px;max-height:260px}
.cp-msgs::-webkit-scrollbar{width:3px}
.cp-msgs::-webkit-scrollbar-thumb{background:var(--bg3);border-radius:2px}
.cp-bar{display:flex;gap:6px;padding:10px 12px;border-top:1px solid var(--border)}
.cp-inp{flex:1}.cp-inp .form-control{border-radius:50px;padding:8px 14px;font-size:12px}
.cp-send{background:linear-gradient(135deg,var(--indigo),var(--purple));border:none;border-radius:50%;width:34px;height:34px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0;transition:var(--tr)}
.cp-send:hover{transform:scale(1.1)}

/* BUTTONS */
.btn{display:inline-flex;align-items:center;justify-content:center;gap:7px;padding:12px 24px;border-radius:50px;border:none;cursor:pointer;font-family:'DM Sans',sans-serif;font-size:13px;font-weight:600;transition:var(--tr);text-decoration:none;letter-spacing:0.2px}
.btn-primary{background:linear-gradient(135deg,var(--indigo),var(--purple));color:#fff;box-shadow:0 4px 20px rgba(124,110,250,0.38)}
.btn-primary:hover{transform:translateY(-2px);box-shadow:0 8px 32px rgba(124,110,250,0.55)}
.btn-primary:disabled{opacity:.5;cursor:not-allowed;transform:none}
.btn-secondary{background:var(--card2);border:1px solid var(--border);color:var(--text)}
.btn-secondary:hover{border-color:var(--indigo)}
.btn-ghost{background:rgba(124,110,250,0.1);border:1px solid rgba(124,110,250,0.2);color:var(--indigo)}
.btn-ghost:hover{background:rgba(124,110,250,0.2)}
.btn-sm{padding:7px 15px;font-size:11px}
.btn-lg{padding:15px 32px;font-size:15px}
.btn-full{width:100%}

/* CARDS */
.card{background:var(--card);border-radius:var(--r);border:1px solid var(--border);padding:22px;transition:var(--tr)}
.card-hov:hover{border-color:rgba(124,110,250,0.5);box-shadow:var(--sh-lg);transform:translateY(-3px)}

/* BADGES */
.badge{display:inline-flex;align-items:center;gap:4px;padding:3px 10px;border-radius:50px;font-size:11px;font-weight:700;letter-spacing:.3px}
.bs{background:rgba(16,185,129,.15);color:#34D399;border:1px solid rgba(16,185,129,.25)}
.bd{background:rgba(239,68,68,.15);color:#F87171;border:1px solid rgba(239,68,68,.25)}
.bw{background:rgba(245,158,11,.15);color:#FCD34D;border:1px solid rgba(245,158,11,.25)}
.bp{background:rgba(124,110,250,.15);color:var(--indigo);border:1px solid rgba(124,110,250,.25)}

/* FORM */
.form-group{margin-bottom:16px}
.form-label{display:block;font-size:11px;font-weight:700;color:var(--text2);margin-bottom:5px;letter-spacing:.5px;text-transform:uppercase}
.form-control{width:100%;padding:11px 14px;border-radius:var(--r-sm);background:var(--bg2);border:1.5px solid var(--border);color:var(--text);font-family:'DM Sans',sans-serif;font-size:13px;transition:var(--tr);outline:none}
.form-control:focus{border-color:var(--indigo);background:var(--bg3);box-shadow:0 0 0 3px rgba(124,110,250,.12)}
.form-control::placeholder{color:var(--text3)}
select.form-control option{background:var(--bg2);color:var(--text)}

/* LAYOUT */
.pw{width:100%;padding:86px 22px 110px;display:flex;flex-direction:column;align-items:center}
.c-sm{width:100%;max-width:460px}
.c-md{width:100%;max-width:680px}
.c-lg{width:100%;max-width:940px}
.stitle{font-size:26px;font-weight:700;margin-bottom:5px;color:var(--text)}
.ssub{color:var(--text2);font-size:13px;margin-bottom:24px;line-height:1.6}
.g2{display:grid;grid-template-columns:1fr 1fr;gap:18px}
.g3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px}
.g4{display:grid;grid-template-columns:repeat(4,1fr);gap:14px}
.tc{text-align:center}
.fjb{display:flex;justify-content:space-between;align-items:center}
.fac{display:flex;align-items:center}
.mt8{margin-top:8px}.mt12{margin-top:12px}.mt16{margin-top:16px}.mt20{margin-top:20px}.mt24{margin-top:24px}
.mb8{margin-bottom:8px}.mb12{margin-bottom:12px}.mb16{margin-bottom:16px}.mb20{margin-bottom:20px}.mb24{margin-bottom:24px}
.gap8{gap:8px}.gap10{gap:10px}.gap12{gap:12px}.gap16{gap:16px}
.w100{width:100%}

@media(max-width:768px){
  .g2,.g3,.g4{grid-template-columns:1fr}
  .pw{padding:76px 14px 100px}
  #topbar{padding:0 14px}
  .stitle{font-size:20px}
  .tb-nav-link{display:none}
}

/* SPLASH */
.spl-orb{position:absolute;width:700px;height:700px;border-radius:50%;background:radial-gradient(circle,rgba(124,110,250,.28) 0%,transparent 70%);top:-200px;left:50%;transform:translateX(-50%);animation:sg 4s ease-in-out infinite}
@keyframes sg{0%,100%{opacity:.5}50%{opacity:.85}}
.spl-ring{position:absolute;border-radius:50%;border:1px solid rgba(124,110,250,.15);top:50%;left:50%;transform:translate(-50%,-50%);animation:rp 8s linear infinite}
@keyframes rp{from{transform:translate(-50%,-50%) scale(1)}to{transform:translate(-50%,-50%) scale(1.06)}}
.spl-logo{font-family:'Sora',sans-serif;font-weight:800;font-size:68px;letter-spacing:-3px;background:linear-gradient(135deg,#C4B5FD,var(--indigo),var(--purple),#EC4899);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-size:300%;animation:gm 4s ease infinite,li .8s ease both}
@keyframes gm{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
@keyframes li{from{opacity:0;transform:scale(.85) translateY(20px)}to{opacity:1;transform:scale(1) translateY(0)}}
.spl-tag{font-size:18px;color:var(--text2);font-weight:400;margin-top:10px;animation:fadeUp .8s .35s ease both}
.spl-sub{font-size:13px;color:var(--text3);margin-top:6px;animation:fadeUp .8s .5s ease both}
.spl-bar{width:180px;height:3px;background:var(--bg3);border-radius:2px;overflow:hidden;margin:36px auto 0;animation:fadeUp .8s .6s ease both}
.spl-fill{height:100%;border-radius:2px;background:linear-gradient(90deg,var(--indigo),var(--purple));animation:lb 3s ease forwards}
@keyframes lb{from{width:0}to{width:100%}}

/* LOGIN */
.login-card{background:var(--card);border:1px solid var(--border);border-radius:24px;padding:40px;width:100%;max-width:420px;box-shadow:var(--sh-lg);position:relative;z-index:2}
.login-logo{font-family:'Sora',sans-serif;font-weight:800;font-size:30px;background:linear-gradient(135deg,var(--indigo),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-align:center;margin-bottom:5px}
.lang-row{display:flex;gap:7px;justify-content:center;margin-bottom:26px}
.lang-btn{padding:5px 13px;border-radius:50px;background:var(--bg2);border:1px solid var(--border);color:var(--text2);font-size:11px;font-weight:600;cursor:pointer;transition:var(--tr);font-family:'DM Sans',sans-serif}
.lang-btn.active,.lang-btn:hover{border-color:var(--indigo);color:var(--indigo)}
.divider{display:flex;align-items:center;gap:10px;margin:14px 0;color:var(--text3);font-size:12px}
.divider::before,.divider::after{content:'';flex:1;height:1px;background:var(--border)}

/* PROFILE CARDS */
.pcard{background:var(--card);border:2px solid var(--border);border-radius:var(--r);padding:28px 22px;cursor:pointer;transition:var(--tr);text-align:center;position:relative;overflow:hidden}
.pcard::before{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:linear-gradient(90deg,var(--indigo),var(--purple));transform:scaleX(0);transition:var(--tr)}
.pcard:hover,.pcard.sel{border-color:rgba(124,110,250,.5);transform:translateY(-5px);box-shadow:var(--sh-lg)}
.pcard:hover::before,.pcard.sel::before{transform:scaleX(1)}
.pcard.sel{background:rgba(124,110,250,.07)}
.pico{font-size:48px;margin-bottom:12px;display:block}
.pcard .pname{font-size:16px;font-weight:700;margin-bottom:6px}
.pdesc{font-size:12px;color:var(--text2);line-height:1.6;margin-bottom:18px}

/* HOME */
.hero{text-align:center;padding:100px 22px 40px;position:relative;z-index:2}
.hero h1{font-size:50px;font-weight:800;line-height:1.1;letter-spacing:-2px;background:linear-gradient(135deg,#C4B5FD,var(--indigo),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:14px}
.hero p{font-size:15px;color:var(--text2);max-width:520px;margin:0 auto 28px;line-height:1.7}
.hero-btns{display:flex;gap:10px;justify-content:center;flex-wrap:wrap}
.feat-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;padding:0 22px;max-width:940px;margin:0 auto 36px;position:relative;z-index:2}
.fcard{background:var(--card);border:1px solid var(--border);border-radius:var(--r);padding:20px;cursor:pointer;transition:var(--tr)}
.fcard:hover{border-color:rgba(124,110,250,.5);transform:translateY(-4px);box-shadow:var(--sh-lg)}
.ficon{font-size:30px;margin-bottom:10px}
.ftitle{font-size:14px;font-weight:700;color:var(--text);margin-bottom:5px}
.fdesc{font-size:11px;color:var(--text2);line-height:1.5}
.farr{font-size:11px;font-weight:700;color:var(--indigo);margin-top:10px;display:flex;align-items:center;gap:3px}

/* USE CASE */
.uccard{background:var(--card);border:2px solid var(--border);border-radius:var(--r);padding:24px;cursor:pointer;transition:var(--tr)}
.uccard:hover{border-color:rgba(124,110,250,.5);transform:translateY(-3px);box-shadow:var(--sh-lg)}
.ucicon{font-size:32px;margin-bottom:10px}
.ucname{font-size:15px;font-weight:700;margin-bottom:5px}
.ucdesc{font-size:11px;color:var(--text2);line-height:1.5;margin-bottom:10px}

/* RESULT */
.res-big{font-family:'Sora',sans-serif;font-size:52px;font-weight:800;letter-spacing:-2px;margin:12px 0}
.cbar-t{background:var(--bg3);border-radius:50px;height:10px;overflow:hidden;margin:10px 0}
.cbar-f{height:100%;border-radius:50px;background:linear-gradient(90deg,var(--indigo),var(--purple));width:0;transition:width 1.2s cubic-bezier(.4,0,.2,1)}
.rstats{display:flex;justify-content:center;gap:24px;margin:20px 0;flex-wrap:wrap}
.rstat{text-align:center}
.rstat-v{font-family:'Sora',sans-serif;font-size:20px;font-weight:800;margin-bottom:2px}
.rstat-l{font-size:10px;color:var(--text3);font-weight:700;text-transform:uppercase;letter-spacing:.5px}

/* EXPLANATION */
.frow{display:flex;align-items:center;gap:12px;background:var(--card);border:1px solid var(--border);border-radius:11px;padding:14px 16px;margin-bottom:9px;transition:var(--tr)}
.frow:hover{border-color:rgba(124,110,250,.35)}
.fnum{width:28px;height:28px;border-radius:50%;background:linear-gradient(135deg,var(--indigo),var(--purple));display:flex;align-items:center;justify-content:center;font-weight:800;font-size:12px;color:#fff;flex-shrink:0}
.fname{font-weight:600;font-size:13px;margin-bottom:2px}
.fsub{font-size:11px;color:var(--text2)}
.ebox{background:rgba(124,110,250,.08);border-left:3px solid var(--indigo);border-radius:0 10px 10px 0;padding:16px 18px;transition:opacity .25s;margin-bottom:14px}
.ebox p{font-size:13px;line-height:1.7;color:var(--text2)}
.emode{font-size:10px;font-weight:700;color:var(--indigo);margin-bottom:7px;text-transform:uppercase;letter-spacing:.5px}
.eacts{display:flex;gap:7px;flex-wrap:wrap}

/* WHAT-IF */
input[type=range]{width:100%;-webkit-appearance:none;height:5px;border-radius:3px;background:var(--bg3);outline:none;cursor:pointer;margin:8px 0}
input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;width:17px;height:17px;border-radius:50%;background:linear-gradient(135deg,var(--indigo),var(--purple));cursor:pointer;box-shadow:0 2px 8px rgba(124,110,250,.5)}
.slg{margin-bottom:22px}
.sll{display:flex;justify-content:space-between;font-size:12px;font-weight:600;color:var(--text2);margin-bottom:2px}
.sll span:last-child{color:var(--indigo)}
.prob-big{font-family:'Sora',sans-serif;font-size:54px;font-weight:800;background:linear-gradient(135deg,var(--indigo),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin:10px 0}
.simtip{background:rgba(124,110,250,.08);border:1px solid rgba(124,110,250,.15);border-radius:10px;padding:10px 13px;font-size:11px;color:var(--indigo);margin-top:12px}

/* METRICS */
.mrow{display:flex;align-items:center;gap:10px;margin-bottom:12px}
.mname{width:140px;font-size:12px;color:var(--text2);flex-shrink:0}
.mtrack{flex:1;background:var(--bg3);border-radius:50px;height:6px;overflow:hidden}
.mfill{height:100%;border-radius:50px;background:linear-gradient(90deg,var(--indigo),var(--purple))}
.mval{width:33px;text-align:right;font-size:12px;font-weight:700;color:var(--indigo)}

/* CHAT */
.chat-win{background:var(--card);border:1px solid var(--border);border-radius:var(--r);display:flex;flex-direction:column;height:480px;overflow:hidden}
.chat-msgs{flex:1;overflow-y:auto;padding:18px;display:flex;flex-direction:column;gap:12px}
.chat-msgs::-webkit-scrollbar{width:3px}
.chat-msgs::-webkit-scrollbar-thumb{background:var(--bg3);border-radius:2px}
.chat-bar{display:flex;gap:7px;padding:12px;border-top:1px solid var(--border)}
.chat-inp{flex:1}.chat-inp .form-control{border-radius:50px;padding:9px 16px}

/* BUBBLE */
.bubble{max-width:78%;padding:10px 15px;border-radius:15px;font-size:12px;line-height:1.6}
.bubble.user{background:linear-gradient(135deg,var(--indigo),var(--purple));color:#fff;align-self:flex-end;border-bottom-right-radius:3px}
.bubble.ai{background:var(--bg2);color:var(--text);align-self:flex-start;border:1px solid var(--border);border-bottom-left-radius:3px}
.aitag{font-size:9px;font-weight:700;color:var(--indigo);margin-bottom:4px;letter-spacing:.5px}
.typing{display:flex;gap:3px;align-items:center}
.tdot{width:5px;height:5px;background:var(--indigo);border-radius:50%;animation:td 1s ease infinite}
.tdot:nth-child(2){animation-delay:.2s}.tdot:nth-child(3){animation-delay:.4s}
@keyframes td{0%,80%,100%{transform:translateY(0)}40%{transform:translateY(-5px)}}

/* QCHIPS */
.qchips{display:flex;flex-wrap:wrap;gap:7px;margin-bottom:14px}
.qchip{padding:6px 13px;border-radius:50px;background:var(--bg2);border:1px solid var(--border);color:var(--text2);font-size:11px;cursor:pointer;transition:var(--tr)}
.qchip:hover{border-color:var(--indigo);color:var(--indigo)}

/* CHURN */
.risk-ring{width:120px;height:120px;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 14px;position:relative}
.risk-score{font-family:'Sora',sans-serif;font-size:28px;font-weight:800}

/* FEEDBACK */
.stars{display:flex;gap:7px;justify-content:center;margin-bottom:20px}
.star{font-size:34px;cursor:pointer;transition:var(--tr);opacity:.3}
.star:hover,.star.on{opacity:1;transform:scale(1.18)}

/* SPINNER */
.spinner{width:20px;height:20px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:spin .7s linear infinite;display:inline-block}
@keyframes spin{to{transform:rotate(360deg)}}

/* STATUS DOT */
.status-dot{width:8px;height:8px;border-radius:50%;background:var(--danger);display:inline-block;margin-right:5px}
.status-dot.online{background:var(--success)}
</style>
</head>
<body>

<div class="orb o1"></div>
<div class="orb o2"></div>
<div class="orb o3"></div>

<!-- TOPBAR -->
<div id="topbar" style="display:none">
  <div class="fac gap10">
    <button class="back-btn" id="backBtn" onclick="goBack()">‚Üê Back</button>
    <div class="tb-logo" onclick="goTo('home')">ClarivoX</div>
  </div>
  <div class="step-bar" id="stepBar"></div>
  <div class="tb-right">
    <button class="tb-nav-link" onclick="goTo('home')">Home</button>
    <button class="tb-nav-link" onclick="goTo('chat')">AI Chat</button>
    <button class="tb-nav-link" onclick="goTo('churn')">Churn</button>
    <div class="profile-pill" onclick="togglePP()">
      <div class="pav" id="tav">U</div>
      <div><div class="pname" id="tpname">User</div><div class="pmode" id="tpmode">‚Äî</div></div>
    </div>
  </div>
</div>

<!-- PROFILE POPUP -->
<div id="ppopup">
  <div class="pp-head">
    <div class="pav" style="width:40px;height:40px;font-size:17px;margin-bottom:8px" id="ppav">U</div>
    <div class="pp-name" id="ppname">User</div>
    <div class="pp-email" id="ppemail">user@clarivox.ai</div>
  </div>
  <div class="pp-item" onclick="goTo('profile');togglePP()">üë§ Switch Profile</div>
  <div class="pp-item" onclick="goTo('chat');togglePP()">üí¨ AI Chat</div>
  <div class="pp-item" onclick="goTo('feedback');togglePP()">‚≠ê Feedback</div>
  <div class="pp-item" onclick="goTo('splash');togglePP()" style="color:var(--danger)">üö™ Sign Out</div>
</div>

<!-- FLOATING CHAT -->
<button id="floatChat" onclick="toggleCP()" title="Ask ClarivoX AI">üí¨<div class="fcbadge">1</div></button>

<!-- CHAT PANEL -->
<div id="cpanel">
  <div class="cp-hd">
    <div class="cp-title">‚ú® ClarivoX Assistant</div>
    <button class="cp-x" onclick="toggleCP()">√ó</button>
  </div>
  <div class="cp-msgs" id="cpmsgs">
    <div class="bubble ai"><div class="aitag">CLARIVOX AI</div>Hi! Ask me anything about banking, loans, or your account.</div>
  </div>
  <div class="cp-bar">
    <div class="cp-inp"><input type="text" class="form-control" id="cpinp" placeholder="Ask a question‚Ä¶" onkeydown="if(event.key==='Enter')cpSend()"/></div>
    <button class="cp-send" onclick="cpSend()">‚û§</button>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PAGES ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

<!-- SPLASH -->
<div class="page active" id="splash">
  <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;flex:1;position:relative;overflow:hidden">
    <div class="spl-orb"></div>
    <div class="spl-ring" style="width:700px;height:700px;opacity:.06"></div>
    <div class="spl-ring" style="width:500px;height:500px;opacity:.09;animation-delay:-3s"></div>
    <div class="spl-ring" style="width:330px;height:330px;opacity:.12;animation-delay:-6s"></div>
    <div style="position:relative;z-index:2;text-align:center">
      <div class="spl-logo">ClarivoX</div>
      <div class="spl-tag">Banking AI That Explains Itself</div>
      <div class="spl-sub">Transparent decisions ¬∑ SHAP powered ¬∑ For everyone</div>
      <div class="spl-bar"><div class="spl-fill"></div></div>
    </div>
  </div>
</div>

<!-- LOGIN -->
<div class="page" id="login">
  <div style="display:flex;align-items:center;justify-content:center;flex:1;position:relative;overflow:hidden">
    <div class="spl-orb" style="opacity:.35"></div>
    <div class="login-card">
      <div class="login-logo">ClarivoX</div>
      <p style="text-align:center;color:var(--text2);font-size:12px;margin-bottom:24px">Explainable AI for Loans, Churn & Banking</p>
      <div class="lang-row">
        <button class="lang-btn active" onclick="setLang(this,'English')">üá¨üáß EN</button>
        <button class="lang-btn" onclick="setLang(this,'Tamil')">üáÆüá≥ TA</button>
        <button class="lang-btn" onclick="setLang(this,'Hindi')">üáÆüá≥ HI</button>
        <button class="lang-btn" onclick="setLang(this,'Telugu')">üáÆüá≥ TE</button>
      </div>
      <div class="form-group">
        <label class="form-label">Your Name</label>
        <input type="text" class="form-control" id="lname" placeholder="Enter your name"/>
      </div>
      <button class="btn btn-primary btn-full mt12" onclick="doLogin()">Get Started ‚Üí</button>
      <div class="divider">or</div>
      <button class="btn btn-secondary btn-full" onclick="doLoginGuest()">Continue as Guest</button>
      <div style="margin-top:16px;text-align:center">
        <span class="status-dot" id="loginDot"></span>
        <span style="font-size:11px;color:var(--text3)" id="loginStatus">Checking backend‚Ä¶</span>
      </div>
    </div>
  </div>
</div>

<!-- PROFILE SELECT -->
<div class="page" id="profile">
  <div class="pw">
    <div class="c-lg">
      <div class="tc mb24">
        <span class="badge bp mb12">Step 1 of 3</span>
        <div class="stitle">Who are you?</div>
        <div class="ssub">We'll personalise AI explanations to match your level</div>
      </div>
      <div class="g3">
        <div class="pcard" onclick="selProfile('Elder',this)">
          <span class="pico">üë¥</span>
          <div class="pname">Elder Mode</div>
          <div class="pdesc">Simple language with real-world analogies. No jargon, just clarity.</div>
          <button class="btn btn-ghost btn-sm w100">Select ‚Üí</button>
        </div>
        <div class="pcard" onclick="selProfile('Student',this)">
          <span class="pico">üéì</span>
          <div class="pname">Student Mode</div>
          <div class="pdesc">School analogies and beginner-friendly context. Understand the how and why.</div>
          <button class="btn btn-ghost btn-sm w100">Select ‚Üí</button>
        </div>
        <div class="pcard" onclick="selProfile('Professional',this)">
          <span class="pico">üíº</span>
          <div class="pname">Professional Mode</div>
          <div class="pdesc">Financial terms, SHAP values, and data-driven insights for experts.</div>
          <button class="btn btn-ghost btn-sm w100">Select ‚Üí</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- HOME -->
<div class="page" id="home">
  <div class="hero" style="position:relative">
    <div class="spl-orb" style="opacity:.22;position:absolute;top:-220px;left:50%;transform:translateX(-50%)"></div>
    <div style="position:relative;z-index:2">
      <span class="badge bp mb12" id="hbadge">‚ú® Explainable Banking AI</span>
      <h1>Banking AI<br/>You Can Trust</h1>
      <p id="htext">ClarivoX explains every AI banking decision in your language ‚Äî loans, customer churn, credit scores ‚Äî powered by SHAP and Groq AI.</p>
      <div class="hero-btns">
        <button class="btn btn-primary btn-lg" onclick="goTo('usecase')">üöÄ Check Loan AI</button>
        <button class="btn btn-secondary btn-lg" onclick="goTo('chat')">üí¨ Ask AI</button>
        <button class="btn btn-ghost btn-lg" onclick="goTo('churn')">üìâ Churn Predictor</button>
      </div>
    </div>
  </div>
  <div class="feat-grid" id="featGrid">
    <div class="fcard" onclick="goTo('usecase')"><div class="ficon">üè¶</div><div class="ftitle">Loan Approval AI</div><div class="fdesc">Understand why your loan was approved or rejected with full SHAP factor breakdown.</div><div class="farr">Analyse ‚Üí</div></div>
    <div class="fcard" onclick="goTo('churn')"><div class="ficon">üìâ</div><div class="ftitle">Churn Predictor</div><div class="fdesc">Predict if a customer will leave the bank and understand the risk factors clearly.</div><div class="farr">Predict ‚Üí</div></div>
    <div class="fcard" onclick="goTo('chat')"><div class="ficon">ü§ñ</div><div class="ftitle">AI Banking Chat</div><div class="fdesc">Ask anything about loans, EMI, credit scores, investments in your language.</div><div class="farr">Ask now ‚Üí</div></div>
    <div class="fcard" onclick="goTo('whatif')"><div class="ficon">üîß</div><div class="ftitle">What-If Simulator</div><div class="fdesc">Change your profile values and see how loan approval probability changes live.</div><div class="farr">Simulate ‚Üí</div></div>
    <div class="fcard" onclick="goTo('transparency')"><div class="ficon">üõ°Ô∏è</div><div class="ftitle">Transparency Report</div><div class="fdesc">See how open, reliable and fair the AI banking decision was with bias metrics.</div><div class="farr">View report ‚Üí</div></div>
    <div class="fcard" onclick="goTo('feedback')"><div class="ficon">‚≠ê</div><div class="ftitle">Rate ClarivoX</div><div class="fdesc">Help us improve by sharing your experience with the AI explanations.</div><div class="farr">Give feedback ‚Üí</div></div>
  </div>
</div>

<!-- USE CASE -->
<div class="page" id="usecase">
  <div class="pw">
    <div class="c-lg">
      <div class="tc mb24">
        <span class="badge bp mb12">Step 2 of 3</span>
        <div class="stitle">What do you want to check?</div>
        <div class="ssub">Select a use case and get a personalised AI explanation</div>
      </div>
      <div class="g4">
        <div class="uccard" onclick="selUC('Loans & EMI',this)">
          <div class="ucicon">üè¶</div><div class="ucname">Loan & EMI</div>
          <div class="ucdesc">Ask about loans, interest rates, EMI calculations.</div>
          <span class="badge bp">Financial</span>
        </div>
        <div class="uccard" onclick="selUC('Credit Score',this)">
          <div class="ucicon">üìä</div><div class="ucname">Credit Score</div>
          <div class="ucdesc">Understand how to improve your CIBIL score.</div>
          <span class="badge bs">Credit</span>
        </div>
        <div class="uccard" onclick="selUC('Savings & Investment',this)">
          <div class="ucicon">üí∞</div><div class="ucname">Savings & Investment</div>
          <div class="ucdesc">Learn about FD, RD, mutual funds and savings.</div>
          <span class="badge bw">Investment</span>
        </div>
        <div class="uccard" onclick="selUC('Insurance',this)">
          <div class="ucicon">üõ°Ô∏è</div><div class="ucname">Insurance</div>
          <div class="ucdesc">Understand life, health, and vehicle insurance.</div>
          <span class="badge bd">Insurance</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- LOAN FORM -->
<div class="page" id="inputform">
  <div class="pw">
    <div class="c-md">
      <div class="mb24">
        <span class="badge bp mb12">Step 3 of 3</span>
        <div class="stitle">Enter Loan Details</div>
        <div class="ssub">Fill in your details for an accurate AI loan assessment</div>
      </div>
      <div class="card">
        <div class="g2">
          <div class="form-group"><label class="form-label">Annual Income (‚Çπ)</label><input type="number" class="form-control" id="fIncome" placeholder="e.g. 500000"/></div>
          <div class="form-group"><label class="form-label">Loan Amount (‚Çπ)</label><input type="number" class="form-control" id="fLoan" placeholder="e.g. 1000000"/></div>
        </div>
        <div class="g2">
          <div class="form-group"><label class="form-label">CIBIL Score</label><input type="number" class="form-control" id="fCibil" placeholder="e.g. 750"/></div>
          <div class="form-group"><label class="form-label">Loan Term (months)</label><input type="number" class="form-control" id="fTerm" placeholder="e.g. 12"/></div>
        </div>
        <div class="g2">
          <div class="form-group"><label class="form-label">Education</label>
            <select class="form-control" id="fEdu"><option value="Graduate">Graduate</option><option value="Not Graduate">Not Graduate</option></select>
          </div>
          <div class="form-group"><label class="form-label">Self Employed?</label>
            <select class="form-control" id="fSelf"><option value="No">No</option><option value="Yes">Yes</option></select>
          </div>
        </div>
        <div class="g2">
          <div class="form-group"><label class="form-label">Dependents</label><input type="number" class="form-control" id="fDep" placeholder="e.g. 0" value="0"/></div>
          <div class="form-group"><label class="form-label">Residential Assets (‚Çπ)</label><input type="number" class="form-control" id="fRes" placeholder="e.g. 0" value="0"/></div>
        </div>
        <button class="btn btn-primary btn-full mt12" id="loanBtn" onclick="submitLoan()">üöÄ Run AI Assessment</button>
        <p style="text-align:center;font-size:10px;color:var(--text3);margin-top:10px">üîí Your data is processed locally and never stored</p>
      </div>
    </div>
  </div>
</div>

<!-- AI RESULT -->
<div class="page" id="airesult" style="align-items:center;justify-content:center">
  <div style="max-width:520px;width:100%;text-align:center;padding:80px 20px">
    <span class="badge" id="rBadge" style="justify-content:center">‚ö° AI Decision Complete</span>
    <div style="font-size:12px;color:var(--text3);margin-top:8px">Loan Approval Assessment ¬∑ LightGBM + SHAP</div>
    <div class="res-big" id="rVerdict" style="color:var(--success)">Approved</div>
    <div class="fjb mb8"><span style="font-size:12px;color:var(--text2)">Model Confidence</span><span style="font-weight:700;color:var(--indigo)" id="rConf">‚Äî%</span></div>
    <div class="cbar-t"><div class="cbar-f" id="rBar"></div></div>
    <div class="rstats">
      <div class="rstat"><div class="rstat-v" id="rRisk">‚Äî</div><div class="rstat-l">Risk Level</div></div>
      <div class="rstat"><div class="rstat-v">LightGBM</div><div class="rstat-l">Model</div></div>
      <div class="rstat"><div class="rstat-v" id="rScore">‚Äî</div><div class="rstat-l">SHAP Score</div></div>
    </div>
    <div id="rAlert" style="border-radius:10px;padding:12px 16px;display:flex;align-items:center;gap:9px;margin-bottom:22px"></div>
    <div style="display:flex;flex-direction:column;gap:9px">
      <button class="btn btn-primary btn-full" onclick="goTo('explanation')">üîç View Full Explanation ‚Üí</button>
      <button class="btn btn-secondary btn-full" onclick="goTo('whatif')">üîß What-If Simulator</button>
      <button class="btn btn-ghost btn-full" onclick="goTo('transparency')">üõ°Ô∏è Transparency Report</button>
    </div>
  </div>
</div>

<!-- EXPLANATION -->
<div class="page" id="explanation">
  <div class="pw">
    <div class="c-lg">
      <div class="mb24">
        <div class="stitle">Why was this decision made?</div>
        <div class="ssub">Top SHAP factors that influenced the AI's outcome, personalised for your profile</div>
      </div>
      <div class="g2" id="explGrid" style="align-items:start">
        <div>
          <div id="shapFactors"></div>
          <div class="eacts mt16 mb16">
            <button class="btn btn-ghost btn-sm" onclick="simplifyExpl()">üßì Simplify</button>
            <button class="btn btn-ghost btn-sm" onclick="goTo('chat')">üí¨ Ask AI</button>
          </div>
          <div style="display:flex;flex-direction:column;gap:8px">
            <button class="btn btn-primary btn-full" onclick="goTo('whatif')">üîß What-If Simulator ‚Üí</button>
            <button class="btn btn-secondary btn-full" onclick="goTo('transparency')">üõ°Ô∏è Transparency Report ‚Üí</button>
          </div>
        </div>
        <div>
          <div class="ebox mb16" id="ebox">
            <div class="emode" id="emode">üë§ Personalised Explanation</div>
            <p id="etxt">Loading AI explanation‚Ä¶</p>
          </div>
          <div class="card">
            <div style="font-size:10px;font-weight:700;color:var(--text3);letter-spacing:.5px;margin-bottom:12px">SHAP FACTOR WEIGHTS</div>
            <div id="shapBars"></div>
          </div>
          <div class="card mt16" style="margin-top:16px;background:rgba(124,110,250,.05)">
            <div style="font-size:10px;font-weight:700;color:var(--text3);letter-spacing:.5px;margin-bottom:8px">üí° ANALOGY</div>
            <p style="font-size:12px;color:var(--text2);line-height:1.7" id="analogyTxt">Loading‚Ä¶</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- WHAT-IF SIMULATOR -->
<div class="page" id="whatif">
  <div class="pw">
    <div class="c-lg">
      <div class="mb24">
        <div class="stitle">What-If Simulator</div>
        <div class="ssub">Adjust sliders to see how changes affect loan approval probability in real time</div>
      </div>
      <div class="g2" id="wiGrid" style="align-items:start">
        <div class="card">
          <div class="slg"><div class="sll"><span>üí∞ Annual Income (‚Çπ)</span><span id="iv">5,00,000</span></div><input type="range" min="100000" max="2000000" step="10000" value="500000" id="is" oninput="updateSim()"/></div>
          <div class="slg"><div class="sll"><span>üìä CIBIL Score</span><span id="cv">700</span></div><input type="range" min="300" max="900" step="10" value="700" id="cs" oninput="updateSim()"/></div>
          <div class="slg"><div class="sll"><span>üè† Loan Amount (‚Çπ)</span><span id="lv">10,00,000</span></div><input type="range" min="100000" max="10000000" step="50000" value="1000000" id="ls" oninput="updateSim()"/></div>
          <div class="simtip" id="simtip">üí° Raise CIBIL score above 750 for the biggest improvement.</div>
        </div>
        <div class="card tc">
          <div style="font-size:10px;font-weight:700;color:var(--text3);letter-spacing:.5px">APPROVAL PROBABILITY</div>
          <div class="prob-big" id="pd">65%</div>
          <div id="pl" style="font-size:13px;font-weight:600;margin-bottom:22px">‚úÖ Likely Approved</div>
          <div style="display:flex;flex-direction:column;gap:8px;margin-top:20px">
            <button class="btn btn-primary btn-full" onclick="goTo('inputform')">üöÄ Run Real Assessment ‚Üí</button>
            <button class="btn btn-secondary btn-full" onclick="goTo('chat')">üí¨ Ask AI ‚Üí</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- CHURN PREDICTOR -->
<div class="page" id="churn">
  <div class="pw">
    <div class="c-md">
      <div class="mb24">
        <div class="stitle">Customer Churn Predictor</div>
        <div class="ssub">Predict if a customer will leave the bank ‚Äî powered by Random Forest + SHAP</div>
      </div>
      <div class="card">
        <div class="g2">
          <div class="form-group"><label class="form-label">Tenure (years)</label><input type="number" class="form-control" id="cTenure" placeholder="e.g. 3"/></div>
          <div class="form-group"><label class="form-label">Account Balance (‚Çπ)</label><input type="number" class="form-control" id="cBalance" placeholder="e.g. 50000"/></div>
        </div>
        <div class="g2">
          <div class="form-group"><label class="form-label">No. of Products</label><input type="number" class="form-control" id="cProducts" placeholder="e.g. 1" value="1"/></div>
          <div class="form-group"><label class="form-label">Satisfaction Score (1-5)</label><input type="number" class="form-control" id="cSatis" placeholder="e.g. 3" min="1" max="5"/></div>
        </div>
        <div class="g2">
          <div class="form-group"><label class="form-label">Number of Complaints</label><input type="number" class="form-control" id="cComplaints" placeholder="e.g. 0" value="0"/></div>
          <div class="form-group"><label class="form-label">Credit Score</label><input type="number" class="form-control" id="cCredit" placeholder="e.g. 650"/></div>
        </div>
        <div class="g2">
          <div class="form-group"><label class="form-label">Age</label><input type="number" class="form-control" id="cAge" placeholder="e.g. 35"/></div>
          <div class="form-group"><label class="form-label">Is Active Member?</label>
            <select class="form-control" id="cActive"><option value="true">Yes</option><option value="false">No</option></select>
          </div>
        </div>
        <button class="btn btn-primary btn-full mt12" id="churnBtn" onclick="submitChurn()">üìâ Predict Churn Risk</button>
      </div>

      <!-- CHURN RESULT -->
      <div class="card mt16" id="churnResult" style="display:none;margin-top:16px">
        <div class="tc mb16">
          <div id="churnVerdict" style="font-family:'Sora',sans-serif;font-size:28px;font-weight:800;margin-bottom:8px"></div>
          <div style="font-size:12px;color:var(--text2)">Risk Score</div>
          <div style="font-family:'Sora',sans-serif;font-size:48px;font-weight:800;background:linear-gradient(135deg,var(--indigo),var(--purple));-webkit-background-clip:text;-webkit-text-fill-color:transparent" id="churnScore"></div>
          <div class="cbar-t"><div class="cbar-f" id="churnBar"></div></div>
        </div>
        <div id="churnExpPoints"></div>
        <div class="card mt12" style="margin-top:12px;background:rgba(124,110,250,.05)">
          <div style="font-size:10px;font-weight:700;color:var(--text3);margin-bottom:6px">üí° ANALOGY</div>
          <p style="font-size:12px;color:var(--text2);line-height:1.7" id="churnAnalogy"></p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- AI CHAT -->
<div class="page" id="chat">
  <div class="pw">
    <div class="c-md">
      <div class="mb16">
        <div class="stitle">Ask ClarivoX AI</div>
        <div class="ssub">Get plain-language answers about banking in your language</div>
      </div>
      <!-- topic + language selectors -->
      <div class="fac gap10 mb16" style="flex-wrap:wrap">
        <select class="form-control" id="chatTopic" style="width:auto;flex:1">
          <option value="Loans & EMI">üè¶ Loans & EMI</option>
          <option value="Credit Score">üìä Credit Score</option>
          <option value="Savings & Investment">üí∞ Savings</option>
          <option value="Insurance">üõ°Ô∏è Insurance</option>
        </select>
        <select class="form-control" id="chatLang" style="width:auto;flex:1">
          <option value="English">üá¨üáß English</option>
          <option value="Tamil">üáÆüá≥ Tamil</option>
          <option value="Hindi">üáÆüá≥ Hindi</option>
          <option value="Telugu">üáÆüá≥ Telugu</option>
        </select>
      </div>
      <div class="qchips">
        <div class="qchip" onclick="qAsk('What is EMI and how is it calculated?')">What is EMI?</div>
        <div class="qchip" onclick="qAsk('How can I improve my CIBIL score?')">Improve CIBIL score</div>
        <div class="qchip" onclick="qAsk('Should I take a home loan?')">Should I take a loan?</div>
        <div class="qchip" onclick="qAsk('What is the difference between FD and RD?')">FD vs RD</div>
        <div class="qchip" onclick="qAsk('How does loan rejection affect credit score?')">Loan rejection impact</div>
      </div>
      <div class="chat-win">
        <div class="chat-msgs" id="chatMsgs">
          <div class="bubble ai"><div class="aitag">‚ú® CLARIVOX AI</div>Hello! I'm here to explain banking decisions in simple terms. Ask me anything about loans, credit scores, or savings!</div>
        </div>
        <div class="chat-bar">
          <div class="chat-inp"><input type="text" class="form-control" id="chatInp" placeholder="Ask a banking question‚Ä¶" onkeydown="if(event.key==='Enter')sendChat()"/></div>
          <button class="btn btn-primary btn-sm" onclick="sendChat()" id="chatSendBtn">Send</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- TRANSPARENCY -->
<div class="page" id="transparency">
  <div class="pw">
    <div class="c-lg">
      <div class="mb24">
        <div class="stitle">Transparency & Bias Report</div>
        <div class="ssub">How open, reliable, and fair was this AI decision?</div>
      </div>
      <div class="g2" id="trGrid" style="align-items:start">
        <div>
          <div class="card tc mb16" style="margin-bottom:16px">
            <div style="font-size:10px;font-weight:700;color:var(--text3);letter-spacing:.5px;margin-bottom:12px">TRANSPARENCY SCORE</div>
            <div style="position:relative;width:120px;height:120px;margin:0 auto 18px">
              <svg width="120" height="120" style="transform:rotate(-90deg)">
                <defs><linearGradient id="cg" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stop-color="#7C6EFA"/><stop offset="100%" stop-color="#A855F7"/></linearGradient></defs>
                <circle cx="60" cy="60" r="48" fill="none" stroke="var(--bg3)" stroke-width="9"/>
                <circle cx="60" cy="60" r="48" fill="none" stroke="url(#cg)" stroke-width="9" stroke-linecap="round" stroke-dasharray="301" stroke-dashoffset="54" id="trCircle"/>
              </svg>
              <div style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);text-align:center">
                <div style="font-family:'Sora',sans-serif;font-size:24px;font-weight:800" id="trScore">82</div>
                <div style="font-size:9px;color:var(--text3)">/100</div>
              </div>
            </div>
            <span class="badge bs">‚úì Good Transparency</span>
          </div>
          <div class="card">
            <div style="font-size:10px;font-weight:700;color:var(--text3);letter-spacing:.5px;margin-bottom:12px">SCORE BREAKDOWN</div>
            <div class="mrow"><div class="mname">Model Confidence</div><div class="mtrack"><div class="mfill" style="width:78%"></div></div><div class="mval">78%</div></div>
            <div class="mrow"><div class="mname">SHAP Stability</div><div class="mtrack"><div class="mfill" style="width:86%"></div></div><div class="mval">86%</div></div>
            <div class="mrow"><div class="mname">Bias Check</div><div class="mtrack"><div class="mfill" style="width:64%;background:linear-gradient(90deg,var(--warning),#F97316)"></div></div><div class="mval" style="color:var(--warning)">64%</div></div>
            <div class="mrow"><div class="mname">Explainability</div><div class="mtrack"><div class="mfill" style="width:90%"></div></div><div class="mval">90%</div></div>
          </div>
        </div>
        <div>
          <div class="card mb16" style="background:rgba(245,158,11,.07);border-color:rgba(245,158,11,.2);margin-bottom:16px">
            <div class="fjb mb12" style="margin-bottom:12px">
              <span style="font-weight:700;font-size:16px">‚öñÔ∏è Bias Detection</span>
              <span class="badge bw">‚ö†Ô∏è Potential Bias</span>
            </div>
            <p style="font-size:12px;color:var(--text2);margin-bottom:12px">A disparity was found in urban vs rural approval rates in the training data.</p>
            <div style="display:flex;gap:14px;flex-wrap:wrap;margin-top:14px">
              <div style="flex:1;min-width:100px;background:var(--bg2);border-radius:10px;padding:14px;text-align:center;border:1px solid var(--border)">
                <div style="font-size:20px;margin-bottom:5px">üèôÔ∏è</div>
                <div style="font-family:'Sora',sans-serif;font-size:26px;font-weight:800;color:var(--indigo)">72%</div>
                <div style="font-size:10px;color:var(--text3);margin-top:4px">Urban Approval</div>
              </div>
              <div style="flex:1;min-width:100px;background:var(--bg2);border-radius:10px;padding:14px;text-align:center;border:1px solid var(--border)">
                <div style="font-size:20px;margin-bottom:5px">üåæ</div>
                <div style="font-family:'Sora',sans-serif;font-size:26px;font-weight:800;color:var(--warning)">39%</div>
                <div style="font-size:10px;color:var(--text3);margin-top:4px">Rural Approval</div>
              </div>
            </div>
          </div>
          <div class="card mb16" style="margin-bottom:16px">
            <div style="font-size:10px;font-weight:700;color:var(--text3);letter-spacing:.5px;margin-bottom:12px">MODEL INFO</div>
            <div class="mrow"><div class="mname">Loan Model</div><div class="mtrack"><div class="mfill" style="width:92%"></div></div><div class="mval">LightGBM</div></div>
            <div class="mrow"><div class="mname">Churn Model</div><div class="mtrack"><div class="mfill" style="width:86%"></div></div><div class="mval">RandForest</div></div>
            <div class="mrow"><div class="mname">AI Engine</div><div class="mtrack"><div class="mfill" style="width:100%"></div></div><div class="mval">Groq</div></div>
            <div class="mrow"><div class="mname">Explainability</div><div class="mtrack"><div class="mfill" style="width:90%"></div></div><div class="mval">SHAP</div></div>
          </div>
          <div style="display:flex;flex-direction:column;gap:8px">
            <button class="btn btn-primary btn-full" onclick="goTo('chat')">üí¨ Ask AI About This ‚Üí</button>
            <button class="btn btn-ghost btn-full" onclick="goTo('feedback')">‚≠ê Rate This ‚Üí</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- FEEDBACK -->
<div class="page" id="feedback" style="align-items:center;justify-content:center">
  <div style="max-width:460px;width:100%;padding:80px 20px;text-align:center">
    <div id="fbForm">
      <span class="badge bp mb12">‚≠ê Rate ClarivoX</span>
      <div class="stitle mt8" style="margin-top:8px">How helpful was the AI?</div>
      <div class="ssub">Your feedback helps us improve for everyone</div>
      <div class="stars mt24" style="margin-top:24px">
        <div class="star" onclick="rateStar(1)">‚≠ê</div>
        <div class="star" onclick="rateStar(2)">‚≠ê</div>
        <div class="star" onclick="rateStar(3)">‚≠ê</div>
        <div class="star" onclick="rateStar(4)">‚≠ê</div>
        <div class="star" onclick="rateStar(5)">‚≠ê</div>
      </div>
      <div class="form-group"><textarea class="form-control" id="fbComment" rows="3" placeholder="Tell us what you liked or what we can improve‚Ä¶"></textarea></div>
      <button class="btn btn-primary btn-full" onclick="submitFB()">Submit Feedback ‚Üí</button>
    </div>
    <div id="fbOk" style="display:none">
      <div style="font-size:64px;margin-bottom:16px">üéâ</div>
      <div style="font-family:'Sora',sans-serif;font-size:48px;font-weight:800;color:var(--success);margin:10px 0" id="fbPct">100%</div>
      <div style="font-size:16px;font-weight:700;margin-bottom:8px">Thank you!</div>
      <div style="color:var(--text2);font-size:13px;margin-bottom:24px">Your feedback has been submitted to our team.</div>
      <button class="btn btn-primary btn-full" onclick="goTo('home')">‚Üê Back to Home</button>
    </div>
  </div>
</div>

<script>
const API = 'http://localhost:8000';
const S = {page:'splash', hist:[], profile:'Student', language:'English', userName:'User', guest:false, loanResult:null};
const STEP_PAGES = ['usecase','inputform','airesult','explanation'];

// ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ
function goTo(id){
  if(S.page!==id) S.hist.push(S.page);
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  const el=document.getElementById(id);
  if(!el){console.warn('Missing page:',id);return;}
  el.classList.add('active');
  S.page=id;
  updateTopbar();
  onEnter(id);
  window.scrollTo(0,0);
}
function goBack(){
  if(!S.hist.length) return;
  const prev=S.hist.pop();
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  const el=document.getElementById(prev);
  if(!el) return;
  el.classList.add('active');
  S.page=prev;
  updateTopbar();
  onEnter(prev);
  window.scrollTo(0,0);
}

// ‚îÄ‚îÄ TOPBAR ‚îÄ‚îÄ
function updateTopbar(){
  const hide=['splash','login'].includes(S.page);
  document.getElementById('topbar').style.display=hide?'none':'flex';
  document.getElementById('floatChat').classList.toggle('show',!hide && S.page!=='chat');
  const bb=document.getElementById('backBtn');
  const noBack=['home','profile','splash','login'].includes(S.page);
  bb.classList.toggle('show',!noBack && S.hist.length>0);
  const bar=document.getElementById('stepBar');
  bar.innerHTML='';
  const ci=STEP_PAGES.indexOf(S.page);
  STEP_PAGES.forEach((_,i)=>{
    const d=document.createElement('div');
    d.className='sdot'+(i<ci?' done':i===ci?' cur':'');
    bar.appendChild(d);
  });
  if(S.profile){
    const initials=(S.guest?'G':S.userName[0]||'U').toUpperCase();
    ['tav','ppav'].forEach(id=>{const e=document.getElementById(id);if(e)e.textContent=initials;});
    document.getElementById('tpname').textContent=S.guest?'Guest':S.userName;
    document.getElementById('tpmode').textContent=S.profile+' Mode';
    document.getElementById('ppname').textContent=S.guest?'Guest User':S.userName;
  }
}

// ‚îÄ‚îÄ ON PAGE ENTER ‚îÄ‚îÄ
function onEnter(id){
  if(id==='airesult' && S.loanResult) showLoanResult(S.loanResult);
  if(id==='explanation' && S.loanResult) showExplanation(S.loanResult);
  if(id==='whatif') updateSim();
  if(id==='home'){
    const n=S.guest?'Explorer':S.userName.split(' ')[0];
    document.getElementById('hbadge').textContent=`üëã Welcome, ${n}`;
    if(S.profile==='Elder') document.getElementById('htext').textContent="We'll explain every AI banking decision in clear, simple language ‚Äî no jargon, just the clarity you deserve.";
    else if(S.profile==='Professional') document.getElementById('htext').textContent="Access SHAP-powered AI explanations, bias audits, and full transparency reports for every banking decision.";
  }
}

// ‚îÄ‚îÄ SPLASH ‚îÄ‚îÄ
setTimeout(()=>goTo('login'),3100);

// ‚îÄ‚îÄ LOGIN ‚îÄ‚îÄ
async function checkServer(){
  try{
    const r=await fetch(API+'/health');
    const d=await r.json();
    const online=d.status==='healthy';
    document.getElementById('loginDot').className='status-dot'+(online?' online':'');
    document.getElementById('loginStatus').textContent=online?'Backend connected ‚úì':'Backend offline ‚Äî check server';
  }catch{
    document.getElementById('loginDot').className='status-dot';
    document.getElementById('loginStatus').textContent='Cannot reach backend';
  }
}
checkServer();

function setLang(b,lang){
  document.querySelectorAll('.lang-btn').forEach(x=>x.classList.remove('active'));
  b.classList.add('active');
  S.language=lang;
}

function doLogin(){
  const nm=document.getElementById('lname').value.trim();
  S.userName=nm||'User';
  S.guest=false;
  goTo('profile');
}
function doLoginGuest(){S.guest=true;goTo('profile');}

// ‚îÄ‚îÄ PROFILE ‚îÄ‚îÄ
function selProfile(mode,card){
  document.querySelectorAll('.pcard').forEach(c=>c.classList.remove('sel'));
  card.classList.add('sel');
  S.profile=mode;
  setTimeout(()=>goTo('home'),350);
}

// ‚îÄ‚îÄ USE CASE ‚îÄ‚îÄ
function selUC(uc,card){
  document.querySelectorAll('.uccard').forEach(c=>c.style.borderColor='');
  card.style.borderColor='rgba(124,110,250,.6)';
  S.useCase=uc;
  setTimeout(()=>goTo('inputform'),280);
}

// ‚îÄ‚îÄ LOAN SUBMIT ‚îÄ‚îÄ
async function submitLoan(){
  const income=+document.getElementById('fIncome').value;
  const loan=+document.getElementById('fLoan').value;
  const cibil=+document.getElementById('fCibil').value;
  const term=+document.getElementById('fTerm').value||12;
  const edu=document.getElementById('fEdu').value;
  const self=document.getElementById('fSelf').value;
  const dep=+document.getElementById('fDep').value||0;
  const res=+document.getElementById('fRes').value||0;
  if(!income||!loan||!cibil){alert('Please fill in Income, Loan Amount, and CIBIL Score!');return;}
  const btn=document.getElementById('loanBtn');
  btn.innerHTML='<div class="spinner"></div> Analysing‚Ä¶';
  btn.disabled=true;
  try{
    const r=await fetch(API+'/api/loan/predict',{
      method:'POST',headers:{'Content-Type':'application/json'},
      body:JSON.stringify({income,loan_amount:loan,cibil_score:cibil,loan_term:term,education:edu,self_employed:self,dependents:dep,residential_assets:res,profile:S.profile,language:S.language})
    });
    const data=await r.json();
    S.loanResult=data;
    goTo('airesult');
  }catch(e){alert('Error connecting to backend! Make sure python main.py is running.');}
  btn.innerHTML='üöÄ Run AI Assessment';
  btn.disabled=false;
}

// ‚îÄ‚îÄ SHOW LOAN RESULT ‚îÄ‚îÄ
function showLoanResult(data){
  const approved=data.prediction==='Approved';
  document.getElementById('rVerdict').textContent=approved?'‚úÖ Approved':'‚ùå Rejected';
  document.getElementById('rVerdict').style.color=approved?'var(--success)':'var(--danger)';
  document.getElementById('rBadge').className='badge '+(approved?'bs':'bd');
  document.getElementById('rBadge').textContent='‚ö° AI Decision Complete';
  const conf=data.confidence||0;
  document.getElementById('rConf').textContent=conf+'%';
  document.getElementById('rScore').textContent=conf>80?'Low Risk':conf>60?'Medium':'High';
  document.getElementById('rRisk').textContent=approved?'Low':'High';
  document.getElementById('rRisk').style.color=approved?'var(--success)':'var(--danger)';
  setTimeout(()=>document.getElementById('rBar').style.width=conf+'%',200);
  const alert=document.getElementById('rAlert');
  if(approved){
    alert.style.cssText='background:rgba(16,185,129,.1);border:1px solid rgba(16,185,129,.2);border-radius:10px;padding:12px 16px;display:flex;align-items:center;gap:9px;margin-bottom:22px';
    alert.innerHTML='<span style="font-size:18px">‚úÖ</span><span style="font-size:12px;color:#34D399">Great news! Your application meets the approval criteria.</span>';
  }else{
    alert.style.cssText='background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.2);border-radius:10px;padding:12px 16px;display:flex;align-items:center;gap:9px;margin-bottom:22px';
    alert.innerHTML='<span style="font-size:18px">‚ö†Ô∏è</span><span style="font-size:12px;color:#F87171">Your application did not meet the minimum criteria. See full explanation below.</span>';
  }
}

// ‚îÄ‚îÄ SHOW EXPLANATION ‚îÄ‚îÄ
function showExplanation(data){
  const shap=data.shap||{};
  const expl=data.explanation||{};
  // Profile mode label
  document.getElementById('emode').textContent=`üë§ Personalised for ${S.profile} Mode`;
  // Explanation points
  const pts=expl.explanation_points||[];
  document.getElementById('etxt').textContent=pts.join(' ');
  // Analogy
  document.getElementById('analogyTxt').textContent=expl.analogy||'‚Äî';
  // SHAP factors list
  const sorted=Object.entries(shap).sort((a,b)=>Math.abs(b[1])-Math.abs(a[1])).slice(0,5);
  const factorsEl=document.getElementById('shapFactors');
  factorsEl.innerHTML=sorted.map(([k,v],i)=>`
    <div class="frow">
      <div class="fnum">${i+1}</div>
      <div style="flex:1">
        <div class="fname">${k.replace(/_/g,' ').replace(/\b\w/g,c=>c.toUpperCase())}</div>
        <div class="fsub">SHAP value: ${v>0?'+':''}${v.toFixed(3)}</div>
      </div>
      <span class="badge ${v>0?'bs':'bd'}">${v>0?'Positive':'Negative'}</span>
    </div>`).join('');
  // SHAP bars
  const max=Math.max(...Object.values(shap).map(Math.abs));
  const barsEl=document.getElementById('shapBars');
  barsEl.innerHTML=sorted.map(([k,v])=>`
    <div class="mrow">
      <div class="mname" style="font-size:11px">${k.replace(/_/g,' ')}</div>
      <div class="mtrack"><div class="mfill" style="width:${Math.abs(v)/max*100}%;background:${v>0?'linear-gradient(90deg,var(--success),#34D399)':'linear-gradient(90deg,var(--danger),#F87171)'}"></div></div>
      <div class="mval" style="color:${v>0?'var(--success)':'var(--danger)'};">${(Math.abs(v)/max*100).toFixed(0)}%</div>
    </div>`).join('');
  // Transparency score
  const ts=expl.transparency_score||82;
  document.getElementById('trScore').textContent=ts;
  const dashoffset=301-(301*(ts/100));
  document.getElementById('trCircle').setAttribute('stroke-dashoffset',dashoffset);
}

// ‚îÄ‚îÄ SIMPLIFY ‚îÄ‚îÄ
async function simplifyExpl(){
  const curr=document.getElementById('etxt').textContent;
  document.getElementById('etxt').textContent='Simplifying‚Ä¶';
  try{
    const r=await fetch(API+'/api/simplify',{
      method:'POST',headers:{'Content-Type':'application/json'},
      body:JSON.stringify({previous_answer:curr,profile:S.profile,language:S.language})
    });
    const d=await r.json();
    if(d.success){
      document.getElementById('etxt').textContent=(d.data.explanation_points||[]).join(' ');
      document.getElementById('analogyTxt').textContent=d.data.analogy||'‚Äî';
      document.getElementById('emode').textContent='üßì Simplified Explanation';
    }
  }catch{document.getElementById('etxt').textContent=curr;}
}

// ‚îÄ‚îÄ WHAT-IF SIM ‚îÄ‚îÄ
function updateSim(){
  const income=+(document.getElementById('is')?.value||500000);
  const credit=+(document.getElementById('cs')?.value||700);
  const loan=+(document.getElementById('ls')?.value||1000000);
  const set=(id,v)=>{const e=document.getElementById(id);if(e)e.textContent=v;};
  set('iv','‚Çπ'+income.toLocaleString('en-IN'));
  set('cv',credit);
  set('lv','‚Çπ'+loan.toLocaleString('en-IN'));
  let prob=0;
  prob+=Math.max(0,(income-100000)/(2000000-100000))*35;
  prob+=Math.max(0,(credit-300)/(900-300))*50;
  prob+=Math.max(0,(1-(loan-100000)/(10000000-100000)))*15;
  prob=Math.min(97,Math.round(prob));
  set('pd',prob+'%');
  const pl=document.getElementById('pl');
  if(pl){
    if(prob>=60){pl.style.color='var(--success)';pl.textContent='‚úÖ Likely Approved';}
    else if(prob>=40){pl.style.color='var(--warning)';pl.textContent='‚ö†Ô∏è Borderline';}
    else{pl.style.color='var(--danger)';pl.textContent='‚ùå Likely Rejected';}
  }
  const tip=document.getElementById('simtip');
  if(tip){
    if(credit<750) tip.textContent='üí° Raise CIBIL score above 750 for the biggest boost.';
    else if(income<600000) tip.textContent='üí° Income above ‚Çπ6L significantly improves chances.';
    else if(loan>5000000) tip.textContent='üí° Lower the loan amount to improve approval odds.';
    else tip.textContent='üéâ Good profile! You\'d likely be approved with these values.';
  }
}

// ‚îÄ‚îÄ CHURN SUBMIT ‚îÄ‚îÄ
async function submitChurn(){
  const tenure=+document.getElementById('cTenure').value;
  const balance=+document.getElementById('cBalance').value;
  const products=+document.getElementById('cProducts').value||1;
  const satisfaction=+document.getElementById('cSatis').value||3;
  const complaints=+document.getElementById('cComplaints').value||0;
  const credit=+document.getElementById('cCredit').value||650;
  const age=+document.getElementById('cAge').value||35;
  const active=document.getElementById('cActive').value==='true';
  if(!tenure&&!balance){alert('Please fill in Tenure and Balance!');return;}
  const btn=document.getElementById('churnBtn');
  btn.innerHTML='<div class="spinner"></div> Predicting‚Ä¶';
  btn.disabled=true;
  try{
    const r=await fetch(API+'/api/churn/predict',{
      method:'POST',headers:{'Content-Type':'application/json'},
      body:JSON.stringify({tenure,balance,products,is_active:active,complaints,credit_score:credit,age,salary:50000,satisfaction,points:400,profile:S.profile,language:S.language})
    });
    const data=await r.json();
    showChurnResult(data);
  }catch(e){alert('Error connecting to backend!');}
  btn.innerHTML='üìâ Predict Churn Risk';
  btn.disabled=false;
}

// ‚îÄ‚îÄ SHOW CHURN RESULT ‚îÄ‚îÄ
function showChurnResult(data){
  const el=document.getElementById('churnResult');
  el.style.display='block';
  const risk=data.risk_score||0;
  const churn=data.will_churn;
  document.getElementById('churnVerdict').textContent=churn?'‚ö†Ô∏è High Churn Risk':'‚úÖ Customer Will Stay';
  document.getElementById('churnVerdict').style.color=churn?'var(--danger)':'var(--success)';
  document.getElementById('churnScore').textContent=risk+'%';
  setTimeout(()=>document.getElementById('churnBar').style.width=risk+'%',200);
  const pts=data.explanation?.explanation_points||[];
  document.getElementById('churnExpPoints').innerHTML=pts.map(p=>`
    <div class="frow"><div class="fnum">‚Üí</div><div style="flex:1"><div class="fsub">${p}</div></div></div>`).join('');
  document.getElementById('churnAnalogy').textContent=data.explanation?.analogy||'‚Äî';
  el.scrollIntoView({behavior:'smooth'});
}

// ‚îÄ‚îÄ CHAT ‚îÄ‚îÄ
const chatHistory=[];
async function sendChat(){
  const inp=document.getElementById('chatInp');
  const q=inp.value.trim();
  if(!q)return;
  appendMsg('chatMsgs',q,'user');
  chatHistory.push({role:'user',content:q});
  inp.value='';
  const btn=document.getElementById('chatSendBtn');
  btn.disabled=true;
  const t=appendTyping('chatMsgs');
  try{
    const topic=document.getElementById('chatTopic')?.value||'Loans & EMI';
    const lang=document.getElementById('chatLang')?.value||S.language;
    const r=await fetch(API+'/api/ask',{
      method:'POST',headers:{'Content-Type':'application/json'},
      body:JSON.stringify({question:q,profile:S.profile,language:lang,topic,history:chatHistory.slice(-6)})
    });
    const data=await r.json();
    t.remove();
    if(data.success){
      const ans=data.data.answer||'Sorry, I could not answer that.';
      appendMsg('chatMsgs',ans,'ai');
      chatHistory.push({role:'assistant',content:ans});
      // show follow up chips
      const fqs=data.data.follow_up_questions||[];
      if(fqs.length){
        const chips=document.createElement('div');
        chips.className='qchips';
        chips.style.marginTop='4px';
        fqs.forEach(fq=>{
          const c=document.createElement('div');
          c.className='qchip';
          c.textContent=fq;
          c.onclick=()=>{document.getElementById('chatInp').value=fq;sendChat();};
          chips.appendChild(c);
        });
        document.getElementById('chatMsgs').appendChild(chips);
        document.getElementById('chatMsgs').scrollTop=99999;
      }
    }else{
      t.remove();
      appendMsg('chatMsgs','Sorry, something went wrong. Please try again.','ai');
    }
  }catch(e){
    t.remove();
    appendMsg('chatMsgs','Cannot reach backend. Make sure python main.py is running.','ai');
  }
  btn.disabled=false;
}

function qAsk(q){document.getElementById('chatInp').value=q;sendChat();}

function appendMsg(cid,txt,role){
  const c=document.getElementById(cid);if(!c)return;
  const b=document.createElement('div');
  b.className='bubble '+role;
  if(role==='ai')b.innerHTML=`<div class="aitag">‚ú® CLARIVOX AI</div>${txt}`;
  else b.textContent=txt;
  c.appendChild(b);c.scrollTop=c.scrollHeight;return b;
}
function appendTyping(cid){
  const c=document.getElementById(cid);if(!c)return document.createElement('div');
  const b=document.createElement('div');
  b.className='bubble ai';
  b.innerHTML='<div class="aitag">‚ú® CLARIVOX AI</div><div class="typing"><div class="tdot"></div><div class="tdot"></div><div class="tdot"></div></div>';
  c.appendChild(b);c.scrollTop=c.scrollHeight;return b;
}

// ‚îÄ‚îÄ FLOATING CHAT ‚îÄ‚îÄ
let cpOpen=false;
function toggleCP(){
  cpOpen=!cpOpen;
  document.getElementById('cpanel').classList.toggle('open',cpOpen);
  if(cpOpen){const b=document.querySelector('#floatChat .fcbadge');if(b)b.style.display='none';}
}
async function cpSend(){
  const inp=document.getElementById('cpinp');
  if(!inp||!inp.value.trim())return;
  const q=inp.value.trim();
  cpAppend(q,'user');
  inp.value='';
  const t=cpTyping();
  try{
    const r=await fetch(API+'/api/ask',{
      method:'POST',headers:{'Content-Type':'application/json'},
      body:JSON.stringify({question:q,profile:S.profile,language:S.language,topic:'Loans & EMI',history:[]})
    });
    const data=await r.json();
    t.remove();
    cpAppend(data.success?data.data.answer:'Sorry, try again.','ai');
  }catch{t.remove();cpAppend('Backend offline. Run python main.py first.','ai');}
}
function cpAppend(txt,role){
  const c=document.getElementById('cpmsgs');if(!c)return;
  const b=document.createElement('div');
  b.className='bubble '+role;b.style.maxWidth='92%';
  if(role==='ai')b.innerHTML=`<div class="aitag">CLARIVOX AI</div>${txt}`;else b.textContent=txt;
  c.appendChild(b);c.scrollTop=c.scrollHeight;return b;
}
function cpTyping(){
  const c=document.getElementById('cpmsgs');
  const b=document.createElement('div');b.className='bubble ai';b.style.maxWidth='92%';
  b.innerHTML='<div class="aitag">CLARIVOX AI</div><div class="typing"><div class="tdot"></div><div class="tdot"></div><div class="tdot"></div></div>';
  c.appendChild(b);c.scrollTop=c.scrollHeight;return b;
}

// ‚îÄ‚îÄ PROFILE POPUP ‚îÄ‚îÄ
let ppOpen=false;
function togglePP(){ppOpen=!ppOpen;document.getElementById('ppopup').classList.toggle('open',ppOpen);}
document.addEventListener('click',e=>{
  if(!e.target.closest('.profile-pill')&&!e.target.closest('#ppopup')&&ppOpen){
    ppOpen=false;document.getElementById('ppopup').classList.remove('open');
  }
});

// ‚îÄ‚îÄ FEEDBACK ‚îÄ‚îÄ
let sr=0;
function rateStar(n){sr=n;document.querySelectorAll('.star').forEach((s,i)=>s.classList.toggle('on',i<n));}
async function submitFB(){
  const comment=document.getElementById('fbComment').value;
  try{
    await fetch(API+'/api/feedback',{
      method:'POST',headers:{'Content-Type':'application/json'},
      body:JSON.stringify({question:'UI Feedback',answer:'N/A',rating:sr,profile:S.profile,language:S.language,comment})
    });
  }catch(e){}
  document.getElementById('fbForm').style.display='none';
  const ok=document.getElementById('fbOk');
  ok.style.display='block';
  document.getElementById('fbPct').textContent=Math.round((sr/5)*100)+'%';
}

// ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ
function resp(){
  const m=window.innerWidth<768;
  ['explGrid','wiGrid','trGrid'].forEach(id=>{const e=document.getElementById(id);if(e)e.style.gridTemplateColumns=m?'1fr':'1fr 1fr';});
  const fg=document.getElementById('featGrid');
  if(fg)fg.style.gridTemplateColumns=m?'1fr':window.innerWidth<1024?'1fr 1fr':'1fr 1fr 1fr';
}
window.addEventListener('resize',resp);
resp();
</script>
</body>
</html>
